{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane/webpack/bootstrap","webpack://office-addin-taskpane/webpack/runtime/define property getters","webpack://office-addin-taskpane/webpack/runtime/global","webpack://office-addin-taskpane/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane/webpack/runtime/publicPath","webpack://office-addin-taskpane/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane/./src/taskpane/taskpane.ts","webpack://office-addin-taskpane/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office, console */\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.PowerPoint) {\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\n    document.getElementById(\"app-body\").style.display = \"flex\";\n\n    // Add event listeners for simplified API buttons\n    document.getElementById(\"check-permission\").onclick = checkPermissionStatus;\n    document.getElementById(\"request-permission\").onclick = requestMicrophonePermission;\n    document.getElementById(\"get-devices\").onclick = getMicrophoneDevices;\n  }\n});\n\nlet hasShownPermissionHint = false;\n\n// ============================================\n// 1. Check Permission Status\n// ============================================\nexport async function checkPermissionStatus() {\n  try {\n    console.log(\"Checking permission status...\");\n    updateStatus(\"Checking microphone permission status...\", \"info\");\n\n    // Check if API is available\n    if (!Office.devicePermission) {\n      updateStatus(\"‚ùå Device Permission API is not available\", \"error\");\n      updatePermissionType(\"Requires Office on the web (Excel, PowerPoint, Word, or Outlook)\");\n      return;\n    }\n\n    // Check platform\n    if (Office.context.platform !== Office.PlatformType.OfficeOnline) {\n      updateStatus(\"‚ùå Not running on Office on the web\", \"error\");\n      updatePermissionType(\"Current platform: \" + Office.context.platform);\n      return;\n    }\n\n    // Check browser permission state using Web API\n    if (navigator.permissions) {\n      try {\n        const permissionStatus = await navigator.permissions.query({ name: 'microphone' as PermissionName });\n        console.log(\"Permission state:\", permissionStatus.state);\n\n        if (permissionStatus.state === 'granted') {\n          updateStatus(\"‚úÖ Microphone permission is GRANTED\", \"success\");\n          updatePermissionType(\"Permission is active. Type: Cannot determine if 'Always' or 'Allow Once' from browser API alone.\");\n          hidePermissionHint();\n        } else if (permissionStatus.state === 'denied') {\n          updateStatus(\"‚õî Microphone permission is DENIED\", \"error\");\n          updatePermissionType(\"User has blocked microphone access. Clear site permissions in browser settings.\");\n          hidePermissionHint();\n        } else {\n          updateStatus(\"‚ö†Ô∏è Microphone permission is PROMPT (not yet decided)\", \"info\");\n          updatePermissionType(\"User hasn't granted or denied permission yet. Click 'Request Permission' to prompt.\");\n          showPermissionHintOnce(\"Tip: Click 'Request Microphone Permission' to trigger the browser prompt before trying to list devices.\");\n        }\n\n        // Listen for permission changes\n        permissionStatus.onchange = () => {\n          console.log(\"Permission changed to:\", permissionStatus.state);\n          checkPermissionStatus(); // Recheck when permission changes\n        };\n      } catch (error) {\n        console.error(\"Could not query permissions:\", error);\n        updateStatus(\"‚úÖ API is available, but cannot check permission state\", \"info\");\n        updatePermissionType(\"Click 'Request Permission' to proceed.\");\n      }\n    } else {\n      updateStatus(\"‚úÖ API is available\", \"success\");\n      updatePermissionType(\"navigator.permissions API not available. Click 'Request Permission' to proceed.\");\n    }\n  } catch (error) {\n    console.error(\"Check permission error:\", error);\n    updateStatus(`Error checking permission: ${error instanceof Error ? error.message : error}`, \"error\");\n  }\n}\n\n// ============================================\n// 2. Request Microphone Permission\n// ============================================\nexport async function requestMicrophonePermission() {\n  try {\n    console.log(\"Requesting microphone permission...\");\n    updateStatus(\"Requesting microphone permission...\", \"info\");\n    updatePermissionType(\"\");\n\n    // Check if API is available\n    if (!Office.devicePermission) {\n      updateStatus(\"‚ùå Device Permission API is not available\", \"error\");\n      updatePermissionType(\"Requires Office on the web\");\n      return;\n    }\n\n    // Check platform\n    if (Office.context.platform !== Office.PlatformType.OfficeOnline) {\n      updateStatus(\"‚ùå Only supported in Office on the web\", \"error\");\n      updatePermissionType(\"Current platform: \" + Office.context.platform);\n      return;\n    }\n\n    // Request permission\n    const deviceCapabilities = [Office.DevicePermissionType.microphone];\n    const isFirstTimeGrant = await Office.devicePermission.requestPermissions(deviceCapabilities);\n\n    if (isFirstTimeGrant) {\n      // User clicked \"Allow\" or \"Allow Once\" for the first time\n      updateStatus(\"‚úÖ Permission granted! Reloading in 2 seconds...\", \"success\");\n      updatePermissionType(\"First-time grant detected. The add-in will reload to apply permissions.\");\n\n      hidePermissionHint();\n\n      setTimeout(() => {\n        console.log(\"Reloading after first-time permission grant...\");\n        location.reload();\n      }, 2000);\n    } else {\n      // Permission was already granted previously\n      updateStatus(\"‚úÖ Permission already granted (using existing permission)\", \"success\");\n      updatePermissionType(\"This permission was granted earlier. Type: 'Always' if persistent after tab close, 'Allow Once' if requires re-grant after tab close.\");\n\n      hidePermissionHint();\n\n      // Test that we can access microphone\n      await waitForPermissionPropagation();\n      testMicrophoneAccess();\n    }\n  } catch (error) {\n    console.error(\"Request permission error:\", error);\n    const errorMessage = error instanceof Error ? error.message : String(error);\n\n    if (errorMessage.includes(\"denied\")) {\n      updateStatus(\"‚õî Permission DENIED by user\", \"error\");\n      updatePermissionType(\"User clicked 'Deny'. You can request permission again, and the user will be prompted again.\");\n    } else {\n      updateStatus(`‚ùå Error: ${errorMessage}`, \"error\");\n      updatePermissionType(\"\");\n    }\n  }\n}\n\n// ============================================\n// 3. Get Microphone Devices\n// ============================================\nexport async function getMicrophoneDevices() {\n  try {\n    console.log(\"Getting microphone devices...\");\n    updateStatus(\"Enumerating microphone devices...\", \"info\");\n\n    if (!navigator.mediaDevices) {\n      updateStatus(\"‚ùå MediaDevices API not available\", \"error\");\n      return;\n    }\n\n    // Get active stream first to expose device labels (W3C spec requirement)\n    // This works cross-browser and is the recommended pattern per MDN\n    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n    console.log(\"‚úÖ Microphone access granted\");\n\n    // Enumerate devices while stream is active - labels will be populated\n    const devices = await navigator.mediaDevices.enumerateDevices();\n    const audioInputs = devices.filter(device => device.kind === 'audioinput');\n\n    // Stop the stream immediately after enumeration\n    stream.getTracks().forEach(track => track.stop());\n\n    console.log(`Found ${audioInputs.length} audio input device(s)`);\n\n    if (audioInputs.length === 0) {\n      updateStatus(\"‚ö†Ô∏è No microphone devices found\", \"error\");\n      updatePermissionType(\"Make sure a microphone is connected.\");\n      clearDeviceList();\n      return;\n    }\n\n    updateStatus(`‚úÖ Found ${audioInputs.length} microphone device(s)`, \"success\");\n    updatePermissionType(\"Devices are accessible with permission granted.\");\n    displayDevices(audioInputs, true);\n  } catch (error) {\n    console.error(\"Get devices error:\", error);\n    const errorMsg = error instanceof Error ? error.message : String(error);\n\n    if (errorMsg.includes(\"Permission denied\") || errorMsg.includes(\"NotAllowedError\")) {\n      updateStatus(\"‚ö†Ô∏è Microphone access denied. Click 'Request Permission' first.\", \"error\");\n      updatePermissionType(\"Permission not granted or user declined.\");\n    } else {\n      updateStatus(`‚ùå Error: ${errorMsg}`, \"error\");\n    }\n    clearDeviceList();\n  }\n}\n\n// ============================================\n// Helper Functions\n// ============================================\n\nfunction updateStatus(message: string, type: \"success\" | \"error\" | \"info\") {\n  const statusElement = document.getElementById(\"permission-status\");\n  const statusText = document.getElementById(\"status-text\");\n\n  if (statusElement && statusText) {\n    statusText.textContent = message;\n    statusElement.style.display = \"block\";\n\n    // Update styling based on type\n    if (type === \"success\") {\n      statusElement.style.borderLeft = \"4px solid #107C10\";\n      statusElement.style.background = \"#DFF6DD\";\n    } else if (type === \"error\") {\n      statusElement.style.borderLeft = \"4px solid #D13438\";\n      statusElement.style.background = \"#FDE7E9\";\n    } else {\n      statusElement.style.borderLeft = \"4px solid #0078D4\";\n      statusElement.style.background = \"#F3F2F1\";\n    }\n  }\n\n  console.log(`[${type.toUpperCase()}] ${message}`);\n}\n\nfunction updatePermissionType(message: string) {\n  const permissionTypeElement = document.getElementById(\"permission-type\");\n  if (permissionTypeElement) {\n    permissionTypeElement.textContent = message;\n    permissionTypeElement.style.display = message ? \"block\" : \"none\";\n  }\n}\n\nfunction displayDevices(devices: MediaDeviceInfo[], hasLabels: boolean) {\n  const deviceListContainer = document.getElementById(\"device-list\");\n  const devicesList = document.getElementById(\"devices\");\n\n  if (deviceListContainer && devicesList) {\n    devicesList.innerHTML = '';\n\n    devices.forEach((device, index) => {\n      const li = document.createElement(\"li\");\n      li.style.padding = \"8px\";\n      li.style.marginBottom = \"4px\";\n      li.style.background = \"#F3F2F1\";\n      li.style.borderRadius = \"4px\";\n\n      const label = device.label || `(empty label)`;\n      const deviceId = device.deviceId.substring(0, 20) + \"...\";\n\n      li.innerHTML = `\n        <div style=\"font-weight: 600;\">${index + 1}. ${hasLabels ? 'üé§' : '‚ö†Ô∏è'} ${label}</div>\n        <div style=\"font-size: 11px; color: #605E5C; margin-top: 4px;\">ID: ${deviceId}</div>\n      `;\n\n      devicesList.appendChild(li);\n    });\n\n    deviceListContainer.style.display = \"block\";\n  }\n}\n\nfunction clearDeviceList() {\n  const deviceListContainer = document.getElementById(\"device-list\");\n  if (deviceListContainer) {\n    deviceListContainer.style.display = \"none\";\n  }\n}\n\nfunction showPermissionHintOnce(message: string) {\n  if (hasShownPermissionHint) {\n    return;\n  }\n\n  const hintElement = document.getElementById(\"permission-hint\");\n  if (hintElement) {\n    hintElement.textContent = message;\n    hintElement.style.display = \"block\";\n    hasShownPermissionHint = true;\n  }\n}\n\nfunction hidePermissionHint() {\n  const hintElement = document.getElementById(\"permission-hint\");\n  if (hintElement) {\n    hintElement.style.display = \"none\";\n  }\n}\n\nasync function testMicrophoneAccess() {\n  try {\n    console.log(\"Testing microphone access...\");\n    // await waitForPermissionPropagation();\n    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });\n    console.log(\"‚úÖ Microphone access successful:\", stream);\n\n    // Stop the stream immediately (we just wanted to test access)\n    stream.getTracks().forEach(track => track.stop());\n  } catch (error) {\n    console.error(\"‚ùå Microphone access test failed:\", error);\n  }\n}\n\nfunction isFirefox() {\n  return navigator.userAgent.toLowerCase().includes(\"firefox\");\n}\n\nasync function waitForPermissionPropagation() {\n  if (!isFirefox()) {\n    return;\n  }\n\n  // Firefox can apply iframe permissions policy asynchronously after load.\n  await new Promise<void>((resolve) => {\n    requestAnimationFrame(() => resolve());\n  });\n}\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./officethemes.css\", import.meta.url);\nvar ___HTML_LOADER_IMPORT_1___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!DOCTYPE html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"> <title>Device Permission Repro</title> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_1___ + \"\\\" rel=\\\"stylesheet\\\"/> <style>.btn-group{display:flex;flex-direction:column;gap:8px;margin:12px 0}.btn-group .ms-Button{width:100%}.step-label{font-weight:600;margin-right:6px}#status{max-height:300px;overflow-y:auto;font-family:monospace;font-size:12px;margin-top:12px}.status-success{color:green}.status-error{color:red}.status-info{color:#0078d4}</style> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <header class=\\\"ms-welcome__header ms-bgColor-neutralLighter\\\"> <h1 class=\\\"ms-font-su\\\">Mic Permission Repro</h1> <p class=\\\"ms-font-m\\\">Issue <a href=\\\"https://github.com/OfficeDev/office-js/issues/5726\\\" target=\\\"_blank\\\">#5726</a></p> </header> <section id=\\\"sideload-msg\\\" class=\\\"ms-welcome__main\\\"> <h2 class=\\\"ms-font-xl\\\">Please sideload your add-in to see app body.</h2> </section> <main id=\\\"app-body\\\" class=\\\"ms-welcome__main\\\" style=\\\"display:none\\\"> <h2 class=\\\"ms-font-xl\\\">Microphone Permission API</h2> <p class=\\\"ms-font-m\\\">Simple interface to test Office DevicePermission API</p> <div id=\\\"permission-hint\\\" class=\\\"permission-hint\\\" style=\\\"display:none\\\"></div> <div class=\\\"btn-group\\\"> <div role=\\\"button\\\" id=\\\"check-permission\\\" class=\\\"ms-Button ms-Button--primary ms-font-m\\\"> <span class=\\\"ms-Button-label\\\">1. Check Permission Status</span> </div> <div role=\\\"button\\\" id=\\\"request-permission\\\" class=\\\"ms-Button ms-Button--hero ms-font-m\\\"> <span class=\\\"ms-Button-label\\\">2. Request Microphone Permission</span> </div> <div role=\\\"button\\\" id=\\\"get-devices\\\" class=\\\"ms-Button ms-Button--primary ms-font-m\\\"> <span class=\\\"ms-Button-label\\\">3. Get Microphone Devices</span> </div> </div> <div id=\\\"permission-status\\\" style=\\\"display:none;margin:12px 0;padding:12px;border-radius:4px;background:#f3f2f1\\\"> <div id=\\\"status-text\\\" class=\\\"ms-font-m\\\"></div> <div id=\\\"permission-type\\\" class=\\\"ms-font-s\\\" style=\\\"margin-top:8px;font-style:italic\\\"></div> </div> <div id=\\\"device-list\\\" style=\\\"display:none;margin:12px 0\\\"> <h3 class=\\\"ms-font-l\\\">Microphone Devices:</h3> <ul id=\\\"devices\\\" style=\\\"list-style:none;padding:0\\\"></ul> </div> </main> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","d","definition","key","o","Object","defineProperty","enumerable","get","g","globalThis","this","Function","e","window","obj","prop","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","configurable","writable","_invoke","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","Office","onReady","info","host","HostType","PowerPoint","getElementById","style","display","onclick","checkPermissionStatus","requestMicrophonePermission","getMicrophoneDevices","hasShownPermissionHint","_checkPermissionStatus","_callee","permissionStatus","_t","_t2","_context","console","log","updateStatus","devicePermission","updatePermissionType","context","platform","PlatformType","OfficeOnline","navigator","permissions","query","name","state","hidePermissionHint","showPermissionHintOnce","onchange","error","concat","message","_requestMicrophonePermission","_callee2","deviceCapabilities","errorMessage","_t3","_context2","DevicePermissionType","microphone","requestPermissions","setTimeout","reload","waitForPermissionPropagation","testMicrophoneAccess","String","includes","_getMicrophoneDevices","_callee3","stream","devices","audioInputs","errorMsg","_t4","_context3","mediaDevices","getUserMedia","audio","enumerateDevices","filter","device","kind","getTracks","forEach","track","stop","clearDeviceList","displayDevices","type","statusElement","statusText","textContent","borderLeft","background","permissionTypeElement","hasLabels","deviceListContainer","devicesList","innerHTML","index","li","createElement","padding","marginBottom","borderRadius","label","deviceId","substring","appendChild","hintElement","_testMicrophoneAccess","_callee4","_t5","_context4","isFirefox","userAgent","toLowerCase","_waitForPermissionPropagation","_callee5","_context5","requestAnimationFrame","URL"],"sourceRoot":""}