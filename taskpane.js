/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={7269:function(e,n,r){e.exports=r.p+"officethemes.css"},58394:function(e,n,r){e.exports=r.p+"taskpane.css"}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var i=n[t]={exports:{}};return e[t](i,i.exports,r),i.exports}r.m=e,r.d=function(e,n){for(var t in n)r.o(n,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},function(){var e;r.g.importScripts&&(e=r.g.location+"");var n=r.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var t=n.getElementsByTagName("script");if(t.length)for(var o=t.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=t[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e}(),r.b=document.baseURI||self.location.href,function(){function e(){var r,t,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.toStringTag||"@@toStringTag";function c(e,o,i,s){var c=o&&o.prototype instanceof u?o:u,l=Object.create(c.prototype);return n(l,"_invoke",function(e,n,o){var i,s,c,u=0,l=o||[],f=!1,p={p:0,n:0,v:r,a:d,f:d.bind(r,4),d:function(e,n){return i=e,s=0,c=r,p.n=n,a}};function d(e,n){for(s=e,c=n,t=0;!f&&u&&!o&&t<l.length;t++){var o,i=l[t],d=p.p,m=i[2];e>3?(o=m===n)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=r):i[0]<=d&&((o=e<2&&d<i[1])?(s=0,p.v=n,p.n=i[1]):d<m&&(o=e<3||i[0]>n||n>m)&&(i[4]=e,i[5]=n,p.n=m,s=0))}if(o||e>1)return a;throw f=!0,n}return function(o,l,m){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,m),s=l,c=m;(t=s<2?r:c)||!f;){i||(s?s<3?(s>1&&(p.n=-1),d(s,c)):p.n=c:p.v=c);try{if(u=2,i){if(s||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),s=1);i=r}else if((t=(f=p.n<0)?c:e.call(n,p))!==a)break}catch(e){i=r,s=1,c=e}finally{u=1}}return{value:t,done:f}}}(e,i,s),!0),l}var a={};function u(){}function l(){}function f(){}t=Object.getPrototypeOf;var p=[][i]?t(t([][i]())):(n(t={},i,function(){return this}),t),d=f.prototype=u.prototype=Object.create(p);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,n(e,s,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=f,n(d,"constructor",f),n(f,"constructor",l),l.displayName="GeneratorFunction",n(f,s,"GeneratorFunction"),n(d),n(d,s,"Generator"),n(d,i,function(){return this}),n(d,"toString",function(){return"[object Generator]"}),(e=function(){return{w:c,m:m}})()}function n(e,r,t,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}n=function(e,r,t,o){if(r)i?i(e,r,{value:t,enumerable:!o,configurable:!o,writable:!o}):e[r]=t;else{var s=function(r,t){n(e,r,function(e){return this._invoke(r,t,e)})};s("next",0),s("throw",1),s("return",2)}},n(e,r,t,o)}function r(e,n,r,t,o,i,s){try{var c=e[i](s),a=c.value}catch(e){return void r(e)}c.done?n(a):Promise.resolve(a).then(t,o)}function t(e){return function(){var n=this,t=arguments;return new Promise(function(o,i){var s=e.apply(n,t);function c(e){r(s,o,i,c,a,"next",e)}function a(e){r(s,o,i,c,a,"throw",e)}c(void 0)})}}Office.onReady(function(e){e.host===Office.HostType.PowerPoint&&(document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("check-permission").onclick=i,document.getElementById("request-permission").onclick=c,document.getElementById("get-devices").onclick=u)});var o=!1;function i(){return s.apply(this,arguments)}function s(){return(s=t(e().m(function n(){var r,t,o;return e().w(function(e){for(;;)switch(e.n){case 0:if(e.p=0,console.log("Checking permission status..."),f("Checking microphone permission status...","info"),Office.devicePermission){e.n=1;break}return f("‚ùå Device Permission API is not available","error"),p("Requires Office on the web (Excel, PowerPoint, Word, or Outlook)"),e.a(2);case 1:if(Office.context.platform===Office.PlatformType.OfficeOnline){e.n=2;break}return f("‚ùå Not running on Office on the web","error"),p("Current platform: "+Office.context.platform),e.a(2);case 2:if(!navigator.permissions){e.n=7;break}return e.p=3,e.n=4,navigator.permissions.query({name:"microphone"});case 4:r=e.v,console.log("Permission state:",r.state),"granted"===r.state?(f("‚úÖ Microphone permission is GRANTED","success"),p("Permission is active. Type: Cannot determine if 'Always' or 'Allow Once' from browser API alone."),y()):"denied"===r.state?(f("‚õî Microphone permission is DENIED","error"),p("User has blocked microphone access. Clear site permissions in browser settings."),y()):(f("‚ö†Ô∏è Microphone permission is PROMPT (not yet decided)","info"),p("User hasn't granted or denied permission yet. Click 'Request Permission' to prompt."),g("Tip: Click 'Request Microphone Permission' to trigger the browser prompt before trying to list devices.")),r.onchange=function(){console.log("Permission changed to:",r.state),i()},e.n=6;break;case 5:e.p=5,t=e.v,console.error("Could not query permissions:",t),f("‚úÖ API is available, but cannot check permission state","info"),p("Click 'Request Permission' to proceed.");case 6:e.n=8;break;case 7:f("‚úÖ API is available","success"),p("navigator.permissions API not available. Click 'Request Permission' to proceed.");case 8:e.n=10;break;case 9:e.p=9,o=e.v,console.error("Check permission error:",o),f("Error checking permission: ".concat(o instanceof Error?o.message:o),"error");case 10:return e.a(2)}},n,null,[[3,5],[0,9]])}))).apply(this,arguments)}function c(){return a.apply(this,arguments)}function a(){return(a=t(e().m(function n(){var r,t,o;return e().w(function(e){for(;;)switch(e.n){case 0:if(e.p=0,console.log("Requesting microphone permission..."),f("Requesting microphone permission...","info"),p(""),Office.devicePermission){e.n=1;break}return f("‚ùå Device Permission API is not available","error"),p("Requires Office on the web"),e.a(2);case 1:if(Office.context.platform===Office.PlatformType.OfficeOnline){e.n=2;break}return f("‚ùå Only supported in Office on the web","error"),p("Current platform: "+Office.context.platform),e.a(2);case 2:return r=[Office.DevicePermissionType.microphone],e.n=3,Office.devicePermission.requestPermissions(r);case 3:if(!e.v){e.n=4;break}f("‚úÖ Permission granted! Reloading in 2 seconds...","success"),p("First-time grant detected. The add-in will reload to apply permissions."),y(),setTimeout(function(){console.log("Reloading after first-time permission grant..."),location.reload()},2e3),e.n=6;break;case 4:return f("‚úÖ Permission already granted (using existing permission)","success"),p("This permission was granted earlier. Type: 'Always' if persistent after tab close, 'Allow Once' if requires re-grant after tab close."),y(),e.n=5,w();case 5:v();case 6:e.n=8;break;case 7:e.p=7,o=e.v,console.error("Request permission error:",o),(t=o instanceof Error?o.message:String(o)).includes("denied")?(f("‚õî Permission DENIED by user","error"),p("User clicked 'Deny'. You can request permission again, and the user will be prompted again.")):(f("‚ùå Error: ".concat(t),"error"),p(""));case 8:return e.a(2)}},n,null,[[0,7]])}))).apply(this,arguments)}function u(){return l.apply(this,arguments)}function l(){return(l=t(e().m(function n(){var r,t,o,i,s;return e().w(function(e){for(;;)switch(e.n){case 0:if(e.p=0,console.log("Getting microphone devices..."),f("Enumerating microphone devices...","info"),navigator.mediaDevices){e.n=1;break}return f("‚ùå MediaDevices API not available","error"),e.a(2);case 1:return e.n=2,navigator.mediaDevices.getUserMedia({audio:!0});case 2:return r=e.v,console.log("‚úÖ Microphone access granted"),e.n=3,navigator.mediaDevices.enumerateDevices();case 3:if(t=e.v,o=t.filter(function(e){return"audioinput"===e.kind}),r.getTracks().forEach(function(e){return e.stop()}),console.log("Found ".concat(o.length," audio input device(s)")),0!==o.length){e.n=4;break}return f("‚ö†Ô∏è No microphone devices found","error"),p("Make sure a microphone is connected."),m(),e.a(2);case 4:f("‚úÖ Found ".concat(o.length," microphone device(s)"),"success"),p("Devices are accessible with permission granted."),d(o,!0),e.n=6;break;case 5:e.p=5,s=e.v,console.error("Get devices error:",s),(i=s instanceof Error?s.message:String(s)).includes("Permission denied")||i.includes("NotAllowedError")?(f("‚ö†Ô∏è Microphone access denied. Click 'Request Permission' first.","error"),p("Permission not granted or user declined.")):f("‚ùå Error: ".concat(i),"error"),m();case 6:return e.a(2)}},n,null,[[0,5]])}))).apply(this,arguments)}function f(e,n){var r=document.getElementById("permission-status"),t=document.getElementById("status-text");r&&t&&(t.textContent=e,r.style.display="block","success"===n?(r.style.borderLeft="4px solid #107C10",r.style.background="#DFF6DD"):"error"===n?(r.style.borderLeft="4px solid #D13438",r.style.background="#FDE7E9"):(r.style.borderLeft="4px solid #0078D4",r.style.background="#F3F2F1")),console.log("[".concat(n.toUpperCase(),"] ").concat(e))}function p(e){var n=document.getElementById("permission-type");n&&(n.textContent=e,n.style.display=e?"block":"none")}function d(e,n){var r=document.getElementById("device-list"),t=document.getElementById("devices");r&&t&&(t.innerHTML="",e.forEach(function(e,r){var o=document.createElement("li");o.style.padding="8px",o.style.marginBottom="4px",o.style.background="#F3F2F1",o.style.borderRadius="4px";var i=e.label||"(empty label)",s=e.deviceId.substring(0,20)+"...";o.innerHTML='\n        <div style="font-weight: 600;">'.concat(r+1,". ").concat(n?"üé§":"‚ö†Ô∏è"," ").concat(i,'</div>\n        <div style="font-size: 11px; color: #605E5C; margin-top: 4px;">ID: ').concat(s,"</div>\n      "),t.appendChild(o)}),r.style.display="block")}function m(){var e=document.getElementById("device-list");e&&(e.style.display="none")}function g(e){if(!o){var n=document.getElementById("permission-hint");n&&(n.textContent=e,n.style.display="block",o=!0)}}function y(){var e=document.getElementById("permission-hint");e&&(e.style.display="none")}function v(){return h.apply(this,arguments)}function h(){return(h=t(e().m(function n(){var r,t;return e().w(function(e){for(;;)switch(e.n){case 0:return e.p=0,console.log("Testing microphone access..."),e.n=1,navigator.mediaDevices.getUserMedia({audio:!0});case 1:r=e.v,console.log("‚úÖ Microphone access successful:",r),r.getTracks().forEach(function(e){return e.stop()}),e.n=3;break;case 2:e.p=2,t=e.v,console.error("‚ùå Microphone access test failed:",t);case 3:return e.a(2)}},n,null,[[0,2]])}))).apply(this,arguments)}function b(){return navigator.userAgent.toLowerCase().includes("firefox")}function w(){return k.apply(this,arguments)}function k(){return(k=t(e().m(function n(){return e().w(function(e){for(;;)switch(e.n){case 0:if(b()){e.n=1;break}return e.a(2);case 1:return e.n=2,new Promise(function(e){requestAnimationFrame(function(){return e()})});case 2:return e.a(2)}},n)}))).apply(this,arguments)}}(),new URL(r(7269),r.b),new URL(r(58394),r.b)}();
//# sourceMappingURL=taskpane.js.map